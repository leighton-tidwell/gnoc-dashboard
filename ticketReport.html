<html>

<head>
  <title>GNOC DV Dashboard</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.14/dist/css/bootstrap-select.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.3/css/bootstrap.min.css" />
  <link rel="stylesheet" href="https://cdn.datatables.net/1.10.22/css/jquery.dataTables.min.css" />
  <link rel="stylesheet" href="https://cdn.datatables.net/buttons/1.6.4/css/buttons.dataTables.min.css" />
  <link rel="stylesheet" href="./css/global.css" />

  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script type="text/javascript"
    src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.3/js/bootstrap.bundle.min.js"></script>
  <script type="text/javascript"
    src="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.14/dist/js/bootstrap-select.min.js"></script>
  <script type="text/javascript" src="https://cdn.datatables.net/1.10.22/js/jquery.dataTables.min.js"></script>
  <script type="text/javascript" src="https://cdn.datatables.net/buttons/1.6.4/js/dataTables.buttons.min.js"></script>
  <script type="text/javascript" src="https://cdn.datatables.net/buttons/1.6.4/js/buttons.html5.min.js"></script>
  <script type="text/javascript" src="https://cdn.datatables.net/buttons/1.6.4/js/buttons.print.min.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.5.0/jszip.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.5.3/jspdf.min.js"></script>
  <script type="text/javascript"
    src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.4.1/html2canvas.min.js"></script>
  <script type="text/javascript" src="./js/user.js"></script>
  <script src="https://unpkg.com/feather-icons/dist/feather.min.js"></script>
  <script>
    var listName = "Tickets";

    var now = new Date();
    var yesterday = new Date();
    var day = ("0" + now.getDate()).slice(-2);
    yesterday.setDate(now.getDate() - 1);
    var previousDay = ("0" + (yesterday.getDate())).slice(-2);
    var month = ("0" + (now.getMonth() + 1)).slice(-2);
    var previousMonth = ("0" + (yesterday.getMonth() + 1)).slice(-2);

    var startDate = now.getFullYear() + "-" + (previousMonth) + "-" + (previousDay) + "T13:00:00Z";
    var endDate = now.getFullYear() + "-" + (month) + "-" + (day) + "T13:00:00Z";

    console.log(previousDay);
    console.log(day);
    $(function () {

      // Check permissions of page:
      if (!checkPermissions("MjQgSE9VUiBSRVBPUlQ=", false, true)) {
        $("html").remove();
      }

      // Permissions of content if page true and let page content run
      if (checkPermissions("MjQgSE9VUiBSRVBPUlQ=", false, false)) {


        // nav
        checkPermissions("REFTSEJPQVJE", "dashboard_div", false);
        checkPermissions("RkxJR0hUIFNDSEVEVUxF", "flight_schedule_div", false);
        if (!checkPermissions("Q1JFQVRFIFRUUw==", "create_tts_div", false) && !checkPermissions("Q1JFQVRFIE1BU1RFUiBUVFM=", "create_master_tts_div", false) && !checkPermissions("VElDS0VUIFNFVFRJTkdT", "ticket_settings_div", false) && !checkPermissions("VklFVyBUSUNLRVRT", "view_tickets_div", false)) {
          $("#tickets_header_div").remove();
        }
        checkPermissions("Q1JFQVRFIFRUUw==", "create_tts_div", false);
        checkPermissions("Q1JFQVRFIE1BU1RFUiBUVFM=", "create_master_tts_div", false);
        checkPermissions("VElDS0VUIFNFVFRJTkdT", "ticket_settings_div", false);
        checkPermissions("VklFVyBUSUNLRVRT", "view_tickets_div", false);
        if (!checkPermissions("Q1JFQVRFIEZMSUdIVCBUSUNLRVQ=", "create_flight_ticket_div", false) && !checkPermissions("VklFVyBGTElHSFQgVElDS0VUUw==", "view_flight_tickets_div", false) && !checkPermissions("VklFVyBNSVNTSU9OUw==", "view_missions_div", false)) {
          $("#flight_tickets_header_div").remove();
        }
        checkPermissions("Q1JFQVRFIEZMSUdIVCBUSUNLRVQ=", "create_flight_ticket_div", false);
        checkPermissions("Q1JFQVRFIEZMSUdIVCBUSUNLRVQ=", "create_flight_ticket_icon_div", false);
        checkPermissions("VklFVyBGTElHSFQgVElDS0VUUw==", "view_flight_tickets_div", false);
        checkPermissions("VklFVyBNSVNTSU9OUw==", "view_missions_div", false);
        if (!checkPermissions("QUREIEEgQ0NJUg==", "add_a_ccir_div", false) && !checkPermissions("VklFVyBDQ0lSUw==", "view_ccirs_div", false)) {
          $("#ccir_header_div").remove();
        }
        checkPermissions("QUREIEEgQ0NJUg==", "add_a_ccir_div", false);
        checkPermissions("QUREIEEgQ0NJUg==", "add_a_ccir_icon_div", false);
        checkPermissions("VklFVyBDQ0lSUw==", "view_ccirs_div", false);
        if (!checkPermissions("MjQgSE9VUiBSRVBPUlQ=", "24_hour_report_div", false)) {
          $("#reports_header_div").remove();
        }
        checkPermissions("MjQgSE9VUiBSRVBPUlQ=", "24_hour_report_div", false);
        checkPermissions("Q09OVEFDVCBMSVNU", "contact_list_div", false);
        checkPermissions("V0VFS0VORCBUSUNLRVQgUkVQT1JU", "weekend_report_div", false);
        checkPermissions("TU9STklORyBTTElERVM=", "morning_slides_div", false);
        checkPermissions("UEVSU09OTkVMIFNUQVRT", "personnel_stats_div", false);
        checkPermissions("TUVUUklDUw==", "monthly_metrics_div", false);
        checkPermissions("UEVSTUlTU0lPTlM=", "permissions_div", false);


        $("#start_date").html(convertDate(startDate, 1));
        $("#end_date").html(convertDate(endDate, 1));


        // Create Modified Ticket Table
        $('#listModifiedTickets').DataTable({
          dom: 'Pfrtip',
          "columnDefs": [
            { "width": "200px", targets: [0] },
            { "width": "50px", targets: [1] },
            { "width": "400px", targets: [6] }
          ],
          searching: false,
          paging: false,
          info: false,
          "order": [[0, "desc"]]
        });

        // Create Open Ticket Table
        $('#listOpenTickets').DataTable({
          dom: 'Pfrtip',
          "columnDefs": [
            { "width": "200px", targets: [0] },
            { "width": "50px", targets: [1] },
            { "width": "100px", targets: [2] },
            { "width": "400px", targets: [5] }
          ],
          "order": [[0, "desc"]],
          searching: false,
          paging: false,
          info: false,
        });

        // Create Fixed Ticket Table
        $('#listFixedTickets').DataTable({
          dom: 'Pfrtip',
          "columnDefs": [
            { "width": "200px", targets: [0] },
            { "width": "50px", targets: [1] },
            { "width": "100px", targets: [2] },
            { "width": "400px", targets: [5] }
          ],
          "order": [[0, "desc"]],
          searching: false,
          paging: false,
          info: false,
        });

        // Create Closed Ticket Table
        $('#listClosedTickets').DataTable({
          dom: 'Pfrtip',
          "columnDefs": [
            { "width": "200px", targets: [0] },
            { "width": "50px", targets: [1] },
            { "width": "400px", targets: [5, 6] }
          ],
          searching: false,
          paging: false,
          info: false,
          "order": [[0, "desc"]]
        });

        // Get all of the modified tickets:
        var urlLoad = "https://intelshare.intelink.gov/sites/89cs/GNOC/_api/web/lists/getbytitle('" + listName + "')/items?$top=5000&$filter=Update_Date le '" + endDate + "' and Update_Date ge '" + startDate + "'";
        $.ajax({
          url: urlLoad,
          async: false,
          method: "GET",
          headers: {
            "Accept": "application/json;odata=verbose"
          },
          success: function (data) {
            var total = 0;
            var arrayOfTimes = [];
            var allResults = data.d.results;
            if (Number(allResults.length) > 0) {
              for (var i = 0; i < Number(allResults.length); i++) {
                // looping through all results
                var currentTime = allResults[i].Created;
                if (!arrayOfTimes.includes(currentTime)) {

                  // this is to make sure no duplicates are included
                  var href = "<a href=\"./viewTicket.html?ticket=" + allResults[i].GNOC_Ticket_Number + "\">" + allResults[i].GNOC_Ticket_Number + "</a>";
                  if (allResults[i].Mission_Number == null)
                    var missionhref = "N/A";
                  else
                    var missionhref = "<a href=\"viewMission.html?mission=" + allResults[i].Mission_Number + "\">" + allResults[i].Mission_Number + "</a>";
                  if (allResults[i].Last_Reported_Action != null && allResults[i].Status != "FIXED" && allResults[i].Status != "CLOSED")
                    $('#listModifiedTickets').DataTable().row.add([href, allResults[i].Tail_Number, missionhref, allResults[i].DV, allResults[i].Impact_Level, allResults[i].Status, allResults[i].Last_Reported_Action]).draw();
                  arrayOfTimes.push(currentTime);
                }
              }
            }
            else {
              console.log("No updated found");
            }
          },
          error: function (data) {
            //alert("Error: " + JSON.stringify(data));
          }
        });

        // Get all of the open tickets:
        var urlLoad = "https://intelshare.intelink.gov/sites/89cs/GNOC/_api/web/lists/getbytitle('" + listName + "')/items?$top=5000&$filter=Created le '" + endDate + "' and Created ge '" + startDate + "'";
        $.ajax({
          url: urlLoad,
          async: false,
          method: "GET",
          headers: {
            "Accept": "application/json;odata=verbose"
          },
          success: function (data) {
            var total = 0;
            var arrayOfTimes = [];
            var allResults = data.d.results;
            if (Number(allResults.length) > 0) {
              for (var i = 0; i < Number(allResults.length); i++) {
                // looping through all results
                var currentTime = allResults[i].Created;

                if (!arrayOfTimes.includes(currentTime)) {
                  // this is to make sure no duplicates are included.
                  var href = "<a href=\"./viewTicket.html?ticket=" + allResults[i].GNOC_Ticket_Number + "\">" + allResults[i].GNOC_Ticket_Number + "</a>";
                  if (allResults[i].Mission_Number == null)
                    var missionhref = "N/A";
                  else
                    var missionhref = "<a href=\"viewMission.html?mission=" + allResults[i].Mission_Number + "\">" + allResults[i].Mission_Number + "</a>";

                  if (allResults[i].CCIR == false)
                    var ccir = "No";
                  else
                    var ccir = "Yes";

                  $('#listOpenTickets').DataTable().row.add([href, allResults[i].Tail_Number, missionhref, allResults[i].DV, allResults[i].Impact_Level, allResults[i].Issue_Description, ccir]).draw();
                  arrayOfTimes.push(currentTime);
                }
              }
            }
          },
          error: function (data) {
            //alert("Error: " + JSON.stringify(data));
          }
        });

        // Get all of the open master tickets:
        var urlLoad = "https://intelshare.intelink.gov/sites/89cs/GNOC/_api/web/lists/getbytitle('masterTickets')/items?$top=5000&$filter=Created le '" + endDate + "' and Created ge '" + startDate + "'";
        $.ajax({
          url: urlLoad,
          async: false,
          method: "GET",
          headers: {
            "Accept": "application/json;odata=verbose"
          },
          success: function (data) {
            var total = 0;
            var arrayOfTimes = [];
            var allResults = data.d.results;
            if (Number(allResults.length) > 0) {
              for (var i = 0; i < Number(allResults.length); i++) {
                // looping through all results
                var currentTime = allResults[i].Created;

                if (!arrayOfTimes.includes(currentTime)) {
                  // this is to make sure no duplicates are included.
                  var href = "<a href=\"./viewMasterTTS.html?ticket=" + allResults[i].Id + "\">" + allResults[i].Title + "</a>";
                  missionhref = "N/A";
                  ccir = "N/A";

                  $('#listOpenTickets').DataTable().row.add([href, "N/A", missionhref, "N/A", "N/A", allResults[i].issue_description, ccir]).draw();
                  arrayOfTimes.push(currentTime);
                }
              }
            }
          },
          error: function (data) {
            //alert("Error: " + JSON.stringify(data));
          }
        });

        // Get all of the fixed tickets:
        var urlLoad = "https://intelshare.intelink.gov/sites/89cs/GNOC/_api/web/lists/getbytitle('ticketUpdates')/items?$top=5000&$filter=Created le '" + endDate + "' and Created ge '" + startDate + "'";
        $.ajax({
          url: urlLoad,
          async: false,
          method: "GET",
          headers: {
            "Accept": "application/json;odata=verbose"
          },
          success: function (data) {
            var arrayOfTimes = [];
            var allResults = data.d.results;
            if (Number(allResults.length) > 0) {
              for (var i = 0; i < Number(allResults.length); i++) {
                // looping through all results
                var currentTime = allResults[i].Created;
                var updateMessage = allResults[i].update;
                var updateString = "GNOC set ticket #" + allResults[i].ticket_number + " to FIXED.";
                if (!arrayOfTimes.includes(currentTime) && updateMessage == updateString) {
                  // this is to make sure no duplicates are included and only update statuses with fixed tickets are included
                  urlLoad = "https://intelshare.intelink.gov/sites/89cs/GNOC/_api/web/lists/getbytitle('Tickets')/items?$filter=GNOC_Ticket_Number eq '" + allResults[i].ticket_number + "'";
                  $.ajax({
                    url: urlLoad,
                    async: false,
                    method: "GET",
                    headers: {
                      "Accept": "application/json;odata=verbose"
                    },
                    success: function (data) {
                      var results = data.d.results;
                      if (Number(results.length) > 0) {
                        var href = "<a href=\"./viewTicket.html?ticket=" + results[0].GNOC_Ticket_Number + "\">" + results[0].GNOC_Ticket_Number + "</a>";
                        if (results[0].Mission_Number == null)
                          var missionhref = "N/A";
                        else
                          var missionhref = "<a href=\"viewMission.html?mission=" + results[0].Mission_Number + "\">" + results[0].Mission_Number + "</a>";


                        $('#listFixedTickets').DataTable().row.add([href, results[0].Tail_Number, missionhref, results[0].DV, results[0].Impact_Level, results[0].Issue_Description, results[0].Last_Reported_Action]).draw();
                        arrayOfTimes.push(currentTime);
                      }
                    }
                  });
                }
              }
            }
          },
          error: function (data) {
            //alert("Error: " + JSON.stringify(data));
          }
        });

        // Get all of the closed tickets:
        var urlLoad = "https://intelshare.intelink.gov/sites/89cs/GNOC/_api/web/lists/getbytitle('ticketUpdates')/items?$top=5000&$filter=Created le '" + endDate + "' and Created ge '" + startDate + "'";
        $.ajax({
          url: urlLoad,
          async: false,
          method: "GET",
          headers: {
            "Accept": "application/json;odata=verbose"
          },
          success: function (data) {
            var arrayOfTimes = [];
            var allResults = data.d.results;
            if (Number(allResults.length) > 0) {
              for (var i = 0; i < Number(allResults.length); i++) {
                // looping through all results
                var currentTime = allResults[i].Created;
                var updateMessage = allResults[i].update;
                var updateString = "GNOC set ticket #" + allResults[i].ticket_number + " to CLOSED.";
                if (!arrayOfTimes.includes(currentTime) && updateMessage == updateString) {
                  // this is to make sure no duplicates are included and only update statuses with fixed tickets are included
                  urlLoad = "https://intelshare.intelink.gov/sites/89cs/GNOC/_api/web/lists/getbytitle('Tickets')/items?$filter=GNOC_Ticket_Number eq '" + allResults[i].ticket_number + "'";
                  $.ajax({
                    url: urlLoad,
                    async: false,
                    method: "GET",
                    headers: {
                      "Accept": "application/json;odata=verbose"
                    },
                    success: function (data) {
                      var results = data.d.results;
                      if (Number(results.length) > 0) {
                        var href = "<a href=\"./viewTicket.html?ticket=" + results[0].GNOC_Ticket_Number + "\">" + results[0].GNOC_Ticket_Number + "</a>";
                        if (results[0].Mission_Number == null)
                          var missionhref = "N/A";
                        else
                          var missionhref = "<a href=\"viewMission.html?mission=" + results[0].Mission_Number + "\">" + results[0].Mission_Number + "</a>";


                        $('#listClosedTickets').DataTable().row.add([href, results[0].Tail_Number, missionhref, results[0].DV, results[0].Impact_Level, results[0].Issue_Description, results[0].Last_Reported_Action]).draw();
                        arrayOfTimes.push(currentTime);
                      }
                    }
                  });
                }
              }
            }
          },
          error: function (data) {
            //alert("Error: " + JSON.stringify(data));
          }
        });
        $(document).on('click', '#genpdf', function () {
          genPDF();
        });
      }
      feather.replace();
    });

    function genPDF() {
      var deferreds = [];
      var doc = new jsPDF('p', 'pt', 'letter');
      for (let i = 1; i < 5; i++) {
        var deferred = $.Deferred();
        deferreds.push(deferred.promise());
        generateCanvas(i, doc, deferred);
      }

      $.when.apply($, deferreds).then(function () { // executes after adding all images
        doc.save($("#header").text().trim() + '.pdf');
      });
    }

    function generateCanvas(i, doc, deferred) {
      if (i == 0)
        i = "header";
      if (i == 1)
        i = "modified";
      if (i == 2)
        i = "open";
      if (i == 3)
        i = "fixed";
      if (i == 4)
        i = "closed";
      html2canvas(document.getElementById(i), {
        quality: 4,
        scale: 5,
        onrendered: function (canvas) {
          var img = canvas.toDataURL();
          //console.log(doc.internal.pageSize.getWidth());
          //console.log(doc.internal.pageSize.getHeight());

          var width = doc.getImageProperties(img);
          //console.log(canvas.width + " x " + canvas.height);
          doc.text(45, 60, $("#header").text());
          doc.addImage(img, 'PNG', 40, 70, canvas.width * .35, canvas.height * .35);
          doc.addPage();

          deferred.resolve();
        }
      });
    }



    function convertDate(date, offset) {
      var convertDate = new Date(date);
      var month = convertDate.getUTCMonth();
      if (convertDate.getUTCMonth() + 1 < 10) {
        month = convertDate.getUTCMonth() + 1;
        month = "0" + month;
      }
      else
        month = convertDate.getUTCMonth() + 1;

      var date = convertDate.getDate();
      if (convertDate.getDate() < 10)
        date = "0" + convertDate.getDate();

      var minutes = convertDate.getUTCMinutes();
      if (convertDate.getUTCMinutes() < 10)
        minutes = "0" + convertDate.getUTCMinutes();

      var t = new Date();
      if (offset == 1) {
        var currentoffset = convertDate.getTimezoneOffset() * 60000;
        convertDate.setTime(convertDate.getTime() + currentoffset);
      }
      var hours = convertDate.getHours();

      if (convertDate.getHours() < 10)
        hours = "0" + hours;

      return dateString = month + "/" + date + "/" + convertDate.getUTCFullYear() + " " + hours + ":" + minutes + "Z";
    }
  </script>
</head>

<body>
  <nav class="navbar navbar-dark bg-dark flex-md-nowrap p-0">
    <a class="navbar-brand col-sm-3 col-md-2 mr-0" href="./index.html">
      <svg width="2em" height="2em" viewBox="0 0 16 16" class="bi bi-broadcast-pin" fill="currentColor"
        xmlns="http://www.w3.org/2000/svg">
        <path fill-rule="evenodd"
          d="M3.05 3.05a7 7 0 0 0 0 9.9.5.5 0 0 1-.707.707 8 8 0 0 1 0-11.314.5.5 0 0 1 .707.707zm2.122 2.122a4 4 0 0 0 0 5.656.5.5 0 0 1-.708.708 5 5 0 0 1 0-7.072.5.5 0 0 1 .708.708zm5.656-.708a.5.5 0 0 1 .708 0 5 5 0 0 1 0 7.072.5.5 0 1 1-.708-.708 4 4 0 0 0 0-5.656.5.5 0 0 1 0-.708zm2.122-2.12a.5.5 0 0 1 .707 0 8 8 0 0 1 0 11.313.5.5 0 0 1-.707-.707 7 7 0 0 0 0-9.9.5.5 0 0 1 0-.707zM6 8a2 2 0 1 1 2.5 1.937V15.5a.5.5 0 0 1-1 0V9.937A2 2 0 0 1 6 8z" />
      </svg> &nbsp;
      <b>GNOC DV Dashboard</b>
    </a>
  </nav>
  <div class="container-fluid">
    <div class="row">
      <nav class="col-md-2 d-none d-md-block bg-light sidebar">
        <div class="sidebar-sticky">
          <ul class="nav flex-column">
            <li class="nav-item" id="dashboard_div">
              <a class="nav-link" href="./index.html">
                <span data-feather="home"></span>
                Dashboard
              </a>
            </li>
            <li class="nav-item" id="flight_schedule_div">
              <a class="nav-link" href="./flightschedule.html">
                <span data-feather="clock"></span>
                Flight Schedule
              </a>
            </li>
            <li class="nav-item" id="contact_list_div">
              <a class="nav-link" href="./contactList.html">
                <span data-feather="phone"></span>
                Contact List
              </a>
            </li>
          </ul>
          <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted"
            id="tickets_header_div">
            <span>Trouble Tickets</span>
            <a class="d-flex align-items-center text-muted" href="./ticketSettings.html" id="ticket_settings_div">
              <span data-feather="settings"></span>
            </a>
          </h6>
          <ul class="nav flex-column mb-2">
            <li class="nav-item" id="create_tts_div">
              <a class="nav-link" href="./createTTS.html">
                <span data-feather="file"></span>
                Create a TTS
              </a>
            </li>
            <li class="nav-item" id="create_master_tts_div">
              <a class="nav-link" href="./createMasterTTS.html">
                <span data-feather="file"></span>
                Create a Master TTS
              </a>
            </li>
            <li class="nav-item" id="view_tickets_div">
              <a class="nav-link" href="./viewTickets.html">
                <span data-feather="file-text"></span>
                View Tickets
              </a>
            </li>
            <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted"
              id="flight_tickets_header_div">
              <span>Flight Tickets</span>
              <a class="d-flex align-items-center text-muted" href="./createFlightTicket.html"
                id="create_flight_ticket_icon_div">
                <span data-feather="plus-circle"></span>
              </a>
            </h6>
            <ul class="nav flex-column mb-2">
              <li class="nav-item" id="create_flight_ticket_div">
                <a class="nav-link" href="./createFlightTicket.html">
                  <span data-feather="file"></span>
                  Create a Flight Ticket
                </a>
              </li>
              <li class="nav-item" id="view_flight_tickets_div">
                <a class="nav-link" href="./viewFlightTickets.html">
                  <span data-feather="file-text"></span>
                  View Flight Tickets
                </a>
              </li>
              <li class="nav-item" id="view_missions_div">
                <a class="nav-link" href="./viewMissions.html">
                  <span data-feather="file-text"></span>
                  View Missions
                </a>
              </li>
            </ul>
            <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted"
              id="ccir_header_div">
              <span>CCIRs</span>
              <a class="d-flex align-items-center text-muted" href="./createCCIR.html" id="add_a_ccir_icon_div">
                <span data-feather="plus-circle"></span>
              </a>
            </h6>
            <ul class="nav flex-column mb-2">
              <li class="nav-item" id="add_a_ccir_div">
                <a class="nav-link" href="./createCCIR.html">
                  <span data-feather="file"></span>
                  Add a CCIR
                </a>
              </li>
              <li class="nav-item" id="view_ccirs_div">
                <a class="nav-link" href="./viewCCIRS.html">
                  <span data-feather="file-text"></span>
                  View CCIRs
                </a>
              </li>
            </ul>
            <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted"
              id="reports_header_div">
              <span>Reports</span>
            </h6>
            <ul class="nav flex-column mb-2">
              <li class="nav-item" id="24_hour_report_div">
                <a class="nav-link active" href="./ticketReport.html">
                  <span data-feather="file-text"></span>
                  24 Hour Ticket Report <span class="sr-only">(current)</span>
                </a>
              </li>
              <li class="nav-item" id="weekend_report_div">
                <a class="nav-link" href="./weekendTicketReport.html">
                  <span data-feather="file-text"></span>
                  Weekend Ticket Report
                </a>
              </li>
              <li class="nav-item" id="morning_slides_div">
                <a class="nav-link" href="./morningSlides.html">
                  <span data-feather="file-text"></span>
                  Morning Slides
                </a>
              </li>
              <li class="nav-item" id="personnel_stats_div">
                <a class="nav-link" href="./personnelStats.html">
                  <span data-feather="file-text"></span>
                  Personnel Stats
                </a>
              </li>
              <li class="nav-item" id="monthly_metrics_div">
                <a class="nav-link" href="./metrics.html">
                  <span data-feather="file-text"></span>
                  Monthly Metrics
                </a>
              </li>
              <li class="nav-item" id="permissions_div">
                <a class="nav-link" href="./permissions.html">
                  <span data-feather="file-text"></span>
                  Permissions
                </a>
              </li>
            </ul>
        </div>
      </nav>
      <main role="main" class="col-md-9 ml-sm-auto col-lg-10 px-4" id="export">
        <div
          class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
          <h1 id="header">Ticket Updates <span id="start_date"></span> - <span id="end_date"></span></h1><span
            class="float-right"><button type="button" id="genpdf" class="btn btn-primary">Download PDF</button></span>
        </div>
        <div class="col-md-12">
          <div class="card" id="modified">
            <div class="card-header">
              <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-archive" fill="currentColor"
                xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd"
                  d="M0 2a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1v7.5a2.5 2.5 0 0 1-2.5 2.5h-9A2.5 2.5 0 0 1 1 12.5V5a1 1 0 0 1-1-1V2zm2 3v7.5A1.5 1.5 0 0 0 3.5 14h9a1.5 1.5 0 0 0 1.5-1.5V5H2zm13-3H1v2h14V2zM5 7.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5z" />
              </svg>
              <b>&nbsp;Modified Tickets</b>
            </div>
            <div class="card-body">
              <table id="listModifiedTickets" class="display" style="width:100%">
                <thead>
                  <tr>
                    <th>ADW Ticket #</th>
                    <th>Tail #</th>
                    <th>Mission #</th>
                    <th>DV</th>
                    <th>DV Impact</th>
                    <th>Status</th>
                    <th>Update</th>
                  </tr>
                </thead>
                <tbody>
                </tbody>
              </table>
            </div>
          </div>
          <br />
          <div class="card" id="open">
            <div class="card-header">
              <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-archive" fill="currentColor"
                xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd"
                  d="M0 2a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1v7.5a2.5 2.5 0 0 1-2.5 2.5h-9A2.5 2.5 0 0 1 1 12.5V5a1 1 0 0 1-1-1V2zm2 3v7.5A1.5 1.5 0 0 0 3.5 14h9a1.5 1.5 0 0 0 1.5-1.5V5H2zm13-3H1v2h14V2zM5 7.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5z" />
              </svg>
              <b>&nbsp;Open Tickets</b>
            </div>
            <div class="card-body">
              <table id="listOpenTickets" class="display" style="width:100%">
                <thead>
                  <tr>
                    <th>ADW Ticket #</th>
                    <th>Tail #</th>
                    <th>Mission #</th>
                    <th>DV</th>
                    <th>DV Impact</th>
                    <th>Issue Description</th>
                    <th>CCIR</th>
                  </tr>
                </thead>
                <tbody>
                </tbody>
              </table>
            </div>
          </div>
          <br />
          <div class="card" id="fixed">
            <div class="card-header">
              <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-archive" fill="currentColor"
                xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd"
                  d="M0 2a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1v7.5a2.5 2.5 0 0 1-2.5 2.5h-9A2.5 2.5 0 0 1 1 12.5V5a1 1 0 0 1-1-1V2zm2 3v7.5A1.5 1.5 0 0 0 3.5 14h9a1.5 1.5 0 0 0 1.5-1.5V5H2zm13-3H1v2h14V2zM5 7.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5z" />
              </svg>
              <b>&nbsp;Fixed Tickets</b>
            </div>
            <div class="card-body">
              <table id="listFixedTickets" class="display" style="width:100%">
                <thead>
                  <tr>
                    <th>ADW Ticket #</th>
                    <th>Tail #</th>
                    <th>Mission #</th>
                    <th>DV</th>
                    <th>DV Impact</th>
                    <th>Issue</th>
                    <th>Fix</th>
                  </tr>
                </thead>
                <tbody>
                </tbody>
              </table>
            </div>
          </div>
          <br />
          <div class="card" id="closed">
            <div class="card-header">
              <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-archive" fill="currentColor"
                xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd"
                  d="M0 2a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1v7.5a2.5 2.5 0 0 1-2.5 2.5h-9A2.5 2.5 0 0 1 1 12.5V5a1 1 0 0 1-1-1V2zm2 3v7.5A1.5 1.5 0 0 0 3.5 14h9a1.5 1.5 0 0 0 1.5-1.5V5H2zm13-3H1v2h14V2zM5 7.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5z" />
              </svg>
              <b>&nbsp;Closed Tickets</b>
            </div>
            <div class="card-body">
              <table id="listClosedTickets" class="display" style="width:100%">
                <thead>
                  <tr>
                    <th>ADW Ticket #</th>
                    <th>Tail #</th>
                    <th>Mission #</th>
                    <th>DV</th>
                    <th>DV Impact</th>
                    <th>Issue</th>
                    <th>Fix</th>
                  </tr>
                </thead>
                <tbody>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </main>
      <br />
      <footer class="py-4 col-md-2 bg-light" style="box-shadow: inset -1px 0 0 rgba(0, 0, 0, .1);">
        <div class="container-fluid">
          <div class="d-flex align-items-center justify-content-between small">
            <div class="text-muted">GNOC DV Dashboard - maintained by GNOC @ JBA<br />
              <a href="mailto:89CS.SCOV.VIP.COMM@us.af.mil">89CS.SCOV.VIP.COMM@us.af.mil</a>
            </div>
          </div>
        </div>
      </footer>
    </div>
  </div>
</body>

</html>