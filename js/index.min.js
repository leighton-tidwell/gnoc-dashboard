var isChromium=window.chrome,winNav=window.navigator,vendorName=winNav.vendor,isOpera=void 0!==window.opr,isIEedge=winNav.userAgent.indexOf("Edge")>-1,isIOSChrome=winNav.userAgent.match("CriOS");isIOSChrome||(null!=isChromium&&"Google Inc."===vendorName&&!1===isOpera&&!1===isIEedge?console.log("Browser is google chrome."):alert("This browser is unsupported, please use Google Chrome."));var nightmode,uniqueDVs=[],allTicketCount=[],options={chart:{renderTo:"containerGraph",type:"bar",events:{redraw:!0}},title:{text:"Tickets per DV"},xAxis:{categories:[],crosshair:!0,labels:{style:{fontSize:"1.2em",color:"#000",fill:"#000"}}},legend:{enabled:!1},yAxis:{min:0,title:{text:"# of Tickets"},labels:{style:{fontSize:"1.2em",color:"#000",fill:"#000"}},allowDecimals:!1},lang:{noData:"No Data Found"},noData:{style:{fontWeight:"bold",fontSize:"15px",color:"#303030"}},series:[],dataSorting:{enabled:!0}},lineOptions={chart:{renderTo:"top5LineChart",type:"line"},title:{text:"Monthly Ticket Snapshot",align:"center"},subtitle:{text:"current year",align:"left"},xAxis:{categories:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},yAxis:{title:{text:" Tickets"},plotLines:[{value:0,width:1,color:"#808080"}],allowDecimals:!1},tooltip:{valuePrefix:"",valueSuffix:" Tickets"},legend:{layout:"horizontal",align:"right",verticalAlign:"top",borderWidth:0,marginTop:5,marginBottom:5},lang:{noData:"No Data Found"},noData:{style:{fontWeight:"bold",fontSize:"15px",color:"#303030"}},series:[]},hostUrl="https://intelshare.intelink.gov/sites/89cs/GNOC/";function getFormDigest(){var e;return $.support.cors=!0,$.ajax({url:hostUrl+"/_api/contextinfo",type:"POST",dataType:"json",headers:{Accept:"application/json; odata=verbose"},xhrFields:{withCredentials:!0},async:!1,success:function(t){e=t.d.GetContextWebInformation.FormDigestValue},error:function(){console.log("Error Occured")}}),e}var digest=getFormDigest();function GetItemTypeForListName(e){return"SP.Data."+e.charAt(0).toUpperCase()+e.split(" ").join("").slice(1)+"ListItem"}function checkNightMode(){"true"==$.cookie("nightmode")?(nightmode=!0,console.log("cookie true"),$('link[href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.3/css/bootstrap.min.css"]').attr("href","https://cdnjs.cloudflare.com/ajax/libs/bootswatch/4.5.3/darkly/bootstrap.min.css"),$('link[href="./css/global.css"]').attr("href","./css/nightMode.css"),$(".sidebar").removeClass("bg-light"),$(".sidebar").addClass("bg-dark"),$(".nav-link.active").removeClass("active").addClass("bg-secondary"),$("footer").removeClass("bg-light").addClass("bg-dark"),$("#nightMode").html('<span data-feather="sun" style="width:23px;height:23px;"></span>'),feather.replace()):(console.log("cookie false"),nightmode=!1,$('link[href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/4.5.3/darkly/bootstrap.min.css"]').attr("href","https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.3/css/bootstrap.min.css"),$('link[href="./css/nightMode.css"]').attr("href","./css/global.css"),$(".sidebar").addClass("bg-light"),$(".sidebar").removeClass("bg-dark"),$(".nav-link.bg-secondary").addClass("active").removeClass("bg-secondary"),$("footer").addClass("bg-light").removeClass("bg-dark"),$("#nightMode").html('<span data-feather="moon" style="width:23px;height:23px;"></span>'),feather.replace())}$(function(){if($.fn.dataTable.moment("MM/DD/YYYY HH:mmZ"),checkPermissions("REFTSEJPQVJE",!1,!1)||($("html").remove(),window.location.replace("https://intelshare.intelink.gov/sites/89cs/GNOC/")),checkPermissions("REFTSEJPQVJE",!1,!1)){checkPermissions("RFYgREVUQUlMUw==","dv_details_div",!1),checkPermissions("T1BFTiBUSUNLRVRT","open_tickets_div",!1),checkPermissions("REFTSEJPQVJE","dashboard_div",!1),checkPermissions("RkxJR0hUIFNDSEVEVUxF","flight_schedule_div",!1),checkPermissions("Q1JFQVRFIFRUUw==","create_tts_div",!1)||checkPermissions("Q1JFQVRFIE1BU1RFUiBUVFM=","create_master_tts_div",!1)||checkPermissions("VElDS0VUIFNFVFRJTkdT","ticket_settings_div",!1)||checkPermissions("VklFVyBUSUNLRVRT","view_tickets_div",!1)||$("#tickets_header_div").remove(),checkPermissions("Q1JFQVRFIFRUUw==","create_tts_div",!1),checkPermissions("Q1JFQVRFIE1BU1RFUiBUVFM=","create_master_tts_div",!1),checkPermissions("VElDS0VUIFNFVFRJTkdT","ticket_settings_div",!1),checkPermissions("VklFVyBUSUNLRVRT","view_tickets_div",!1),checkPermissions("Q1JFQVRFIEZMSUdIVCBUSUNLRVQ=","create_flight_ticket_div",!1)||checkPermissions("VklFVyBGTElHSFQgVElDS0VUUw==","view_flight_tickets_div",!1)||checkPermissions("VklFVyBNSVNTSU9OUw==","view_missions_div",!1)||$("#flight_tickets_header_div").remove(),checkPermissions("Q1JFQVRFIEZMSUdIVCBUSUNLRVQ=","create_flight_ticket_div",!1),checkPermissions("Q1JFQVRFIEZMSUdIVCBUSUNLRVQ=","create_flight_ticket_icon_div",!1),checkPermissions("VklFVyBGTElHSFQgVElDS0VUUw==","view_flight_tickets_div",!1),checkPermissions("VklFVyBNSVNTSU9OUw==","view_missions_div",!1),checkPermissions("QUREIEEgQ0NJUg==","add_a_ccir_div",!1)||checkPermissions("VklFVyBDQ0lSUw==","view_ccirs_div",!1)||$("#ccir_header_div").remove(),checkPermissions("QUREIEEgQ0NJUg==","add_a_ccir_div",!1),checkPermissions("QUREIEEgQ0NJUg==","add_a_ccir_icon_div",!1),checkPermissions("VklFVyBDQ0lSUw==","view_ccirs_div",!1),checkPermissions("MjQgSE9VUiBSRVBPUlQ=","24_hour_report_div",!1)||$("#reports_header_div").remove(),checkPermissions("MjQgSE9VUiBSRVBPUlQ=","24_hour_report_div",!1),checkPermissions("Q09OVEFDVCBMSVNU","contact_list_div",!1),checkPermissions("V0VFS0VORCBUSUNLRVQgUkVQT1JU","weekend_report_div",!1),checkPermissions("TU9STklORyBTTElERVM=","morning_slides_div",!1),checkPermissions("UEVSU09OTkVMIFNUQVRT","personnel_stats_div",!1),checkPermissions("TUVUUklDUw==","monthly_metrics_div",!1),checkPermissions("UEVSTUlTU0lPTlM=","permissions_div",!1),$("#tail_select").on("change",function(e){uniqueDVs=[],allTicketCount=[],options.series=[],options.xAxis.categories=[];var t=void 0;""!=$("#tail_select").val()&&(t=$("#tail_select").val());var s=void 0;""!=$("#dv_select").val()&&(s=$("#dv_select").val());$(this).val();runChart(s,$("#start_date").val()+"T00:00:00Z",$("#end_date").val()+"T23:59:59Z",t)}),$("#year_select").on("change",function(e){var t=$(this).val();lineOptions.subtitle.text=t,lineOptions.series=[],runLineChart(t)});var e="https://intelshare.intelink.gov/sites/89cs/GNOC/_api/web/lists/getbytitle('TailNumbers')/items?$top=5000&$orderby=Tail_x0020_Numbers%20asc";$.ajax({url:e,async:!1,method:"GET",headers:{Accept:"application/json;odata=verbose"},success:function(e){var t=e.d.results;if(Number(t.length)>0){for(var s=document.getElementById("tail_select"),i=0;i<Number(t.length);i++){var a=document.createElement("option");a.innerHTML=t[i].Tail_x0020_Numbers,s.appendChild(a)}$(".selectpicker").selectpicker("refresh")}},error:function(e){}}),$("#dv_select").on("change",function(){uniqueDVs=[],allTicketCount=[],options.series=[],options.xAxis.categories=[];var e=void 0;""!=$("#tail_select").val()&&(e=$("#tail_select").val());var t=void 0;""!=$("#dv_select").val()&&(t=$("#dv_select").val()),runChart(t,$("#start_date").val()+"T00:00:00Z",$("#end_date").val()+"T23:59:59Z",e)}),$("#start_date").change(function(){var e=void 0;""!=$("#tail_select").val()&&(e=$("#tail_select").val());var t=void 0;""!=$("#dv_select").val()&&(t=$("#dv_select").val()),uniqueDVs=[],allTicketCount=[],options.series=[],options.xAxis.categories=[],runChart(t,$("#start_date").val()+"T00:00:00Z",$("#end_date").val()+"T23:59:59Z",e)}),$("#end_date").change(function(){var e=void 0;""!=$("#tail_select").val()&&(e=$("#tail_select").val());var t=void 0;""!=$("#dv_select").val()&&(t=$("#dv_select").val()),uniqueDVs=[],allTicketCount=[],options.series=[],options.xAxis.categories=[],runChart(t,$("#start_date").val()+"T00:00:00Z",$("#end_date").val()+"T23:59:59Z",e)});var t=new Date,s=("0"+t.getDate()).slice(-2),i=("0"+(t.getMonth()+1)).slice(-2),a=t.getFullYear()+"-"+i+"-01",r=t.getFullYear()+"-"+i+"-"+s;$("#start_date").val(a),$("#end_date").val(r);var o=t.getFullYear();lineOptions.subtitle.text=o;for(var n=document.getElementById("year_select"),l=o;l>2018;l--){var c=document.createElement("option");c.innerHTML=l,n.appendChild(c)}$("#year_select").val(o),$(".selectpicker").selectpicker("refresh");e="https://intelshare.intelink.gov/sites/89cs/GNOC/_api/web/lists/getbytitle('DVList')/items?$top=5000&$orderby=DV%20asc";$.ajax({url:e,async:!1,method:"GET",headers:{Accept:"application/json;odata=verbose"},success:function(e){var t=e.d.results;if(Number(t.length)>0){for(var s=document.getElementById("dv_select"),i=0;i<Number(t.length);i++){var a=document.createElement("option");a.innerHTML=t[i].DV,s.appendChild(a)}$(".selectpicker").selectpicker("refresh")}},error:function(e){}}),feather.replace(),runChart(void 0,a=t.getFullYear()+"-"+i+"-01T00:00:00Z",r=t.getFullYear()+"-"+i+"-"+s+"T23:59:59Z",void 0),runLineChart()}});var total_overall_tickets=0;function runChart(e,t,s,i){$.fn.DataTable.isDataTable("#overviewTickets")?$("#overviewTickets").DataTable().clear().draw():$("#overviewTickets").DataTable({dom:"Bfrtip",buttons:["copy","csv","excel","pdf","print"],columnDefs:[{width:"150px",targets:[0,1,10]},{width:"300px",targets:[8]}],order:[[0,"desc"]]});var a,r=[],o=!1;if(void 0===e){var n=1;r=getAllDvs(t,s)}else r=e,o=!0;total_overall_tickets=0,a=getTicketsPerDV(r,t,s,i,o),getStatTotals(n?void 0:r,t,s);for(var l=0,c=0;c<a.length;c++)0==a[c]&&l++;if(l==a.length)$("#containerGraph").text("No Data Found");else new Highcharts.Chart(options)}function getAllDvs(e,t){total_overall_tickets=0;getDvItems("https://intelshare.intelink.gov/sites/89cs/GNOC/_api/web/lists/getbytitle('Tickets')/items?$select=DV,Created&$filter=Created le '"+t+"' and Created ge '"+e+"'&top=5000&$orderby=DV%20asc");return uniqueDVs}function getDvItems(e){var t=t||[];return $.ajax({url:e,async:!1,method:"GET",headers:{Accept:"application/json;odata=verbose"},success:function(s){t=s.d.results;for(var i=0;i<Number(t.length);i++)null!==t[i].DV&&-1==jQuery.inArray(t[i].DV,uniqueDVs)&&uniqueDVs.push(t[i].DV);s.d.__next&&getDvItems(e=s.d.__next)},error:function(e){}}),t}function getTicketsPerDV(e,t,s,i,a){for(var r=0;r<e.length;r++){var o=fetchTicketCount(e[r],t,s,i,a);total_overall_tickets+=o,allTicketCount.push(o)}return $("#total_tickets").text(total_overall_tickets),options.series.push({name:"Tickets",data:allTicketCount}),allTicketCount}function fetchTicketCount(e,t,s,i,a){var r=0,o=0;if(void 0===t&&void 0===s&&void 0===i)var n="https://intelshare.intelink.gov/sites/89cs/GNOC/_api/web/lists/getbytitle('Tickets')/items?$select=DV,Created,GNOC_Ticket_Number,Date_Opened,Tail_Number,Mission_Number,DV_Impact,Impact_Level,Category,Status,Issue_Description,Last_Reported_Action,Update_Date,CCIR,CCIR_Number,CSO&$top=5000&$filter=DV eq '"+encodeURI(e)+"' and Created le '"+s+"' and Created ge '"+t+"'&$orderby=DV%20asc";if(void 0!==t&&void 0!==s&&null==i){r=1;n="https://intelshare.intelink.gov/sites/89cs/GNOC/_api/web/lists/getbytitle('Tickets')/items?$select=DV,Created,GNOC_Ticket_Number,Date_Opened,Tail_Number,Mission_Number,DV_Impact,Impact_Level,Category,Status,Issue_Description,Last_Reported_Action,Update_Date,CCIR,CCIR_Number,CSO&$top=5000&$filter=DV eq '"+encodeURIComponent(e)+"'and Created le '"+s+"' and Created ge '"+t+"'&$orderby=DV%20asc"}if(void 0!==t&&void 0!==s&&void 0!==i){r=1,o=1;n="https://intelshare.intelink.gov/sites/89cs/GNOC/_api/web/lists/getbytitle('Tickets')/items?$select=DV,Created,GNOC_Ticket_Number,Date_Opened,Tail_Number,Mission_Number,DV_Impact,Impact_Level,Category,Status,Issue_Description,Last_Reported_Action,Update_Date,CCIR,CCIR_Number,CSO&$top=5000&$filter=DV eq '"+encodeURIComponent(e)+"'and Created le '"+s+"' and Created ge '"+t+"'&$orderby=DV%20asc"}var l=0;return $.ajax({url:n,async:!1,method:"GET",headers:{Accept:"application/json;odata=verbose"},success:function(n){if(n.d.results.length>0){if(0==r&&0==o)options.xAxis.categories.push(e),l=n.d.results.length;else if(1==r&&0==o){for(var c=0,d=[],v=n.d.results,h=0;h<Number(v.length);h++){var u=v[h].Created;if(d.includes(u));else if(u<=s&&u>=t){d.push(k);var _=convertTheDate(v[h].Date_Opened,1),g=convertTheDate(v[h].Update_Date,1);if(checkPermissions("VklFVyBNSVNTSU9O",!1,!1))var p='<a href="./viewMission.html?mission='+v[h].Mission_Number+'">'+v[h].Mission_Number+"</a>";else p=v[h].Mission_Number;"N/A"!=v[h].Mission_Number&&null!=v[h].Mission_Number||(p="N/A");var m='<a href="./viewTicket.html?ticket='+v[h].GNOC_Ticket_Number+'">'+v[h].GNOC_Ticket_Number+"</a>";$("#overviewTickets").DataTable().row.add([m,_,v[h].Tail_Number,p,v[h].DV,v[h].Impact_Level,v[h].Category,v[h].Status,v[h].Issue_Description,v[h].Last_Reported_Action,g]).draw(),c++}}0!=c&&options.xAxis.categories.push(e),l=c}else if(1==r&&1==o){for(c=0,d=[],v=n.d.results,h=0;h<Number(v.length);h++){var f=v[h].Tail_Number,k=v[h].Created;if(i.includes(f)&&k<=s&&k>=t)if(d.includes(k));else{d.push(k);_=convertTheDate(v[h].Date_Opened,1),g=convertTheDate(v[h].Update_Date,1),m='<a href="./viewTicket.html?ticket='+v[h].GNOC_Ticket_Number+'">'+v[h].GNOC_Ticket_Number+"</a>",p='<a href="./viewMission.html?mission='+v[h].Mission_Number+'">'+v[h].Mission_Number+"</a>";$("#overviewTickets").DataTable().row.add([m,_,v[h].Tail_Number,p,v[h].DV,v[h].Impact_Level,v[h].Category,v[h].Status,v[h].Issue_Description,v[h].Last_Reported_Action,g,v[h].CCIR_Number,v[h].CSO]).draw(),c++}}0!=c&&options.xAxis.categories.push(e),l=c}}else 1==a&&options.xAxis.categories.push(e)},error:function(e){}}),l}function getStatTotals(e,t,s,i){var a=0,r=0,o=0;if(void 0!==e)for(var n=0;n<e.length;n++)a+=getCCIRTotal(e[n],t,s),r+=getMissionTotal(e[n],t,s),o+=getLegTotal(e[n],t,s);else a+=getCCIRTotal(void 0,t,s),r+=getMissionTotal(void 0,t,s),o+=getLegTotal(void 0,t,s);$("#total_ccirs").text(a),$("#total_missions").text(r),$("#total_legs").text(o)}function getCCIRTotal(e,t,s){var i=0;if(void 0!==e)var a="https://intelshare.intelink.gov/sites/89cs/GNOC/_api/web/lists/getbytitle('CCIR')/items?$top=5000&$filter=DV eq '"+encodeURI(e)+"' and Created le '"+s+"' and Created ge '"+t+"'";else a="https://intelshare.intelink.gov/sites/89cs/GNOC/_api/web/lists/getbytitle('CCIR')/items?$top=5000&$filter=Created le '"+s+"' and Created ge '"+t+"'";return $.ajax({url:a,async:!1,method:"GET",headers:{Accept:"application/json;odata=verbose"},success:function(e){e.d.results.length>0&&(i=Number(e.d.results.length))}}),i}function getMissionTotal(e,t,s){var i=[];if(void 0!==e)var a="https://intelshare.intelink.gov/sites/89cs/GNOC/_api/web/lists/getbytitle('Missions')/items?$top=5000&$filter=DV eq '"+encodeURI(e)+"' and Created le '"+s+"' and Created ge '"+t+"'";else a="https://intelshare.intelink.gov/sites/89cs/GNOC/_api/web/lists/getbytitle('Missions')/items?$top=5000&$filter=Created le '"+s+"' and Created ge '"+t+"'";return $.ajax({url:a,async:!1,method:"GET",headers:{Accept:"application/json;odata=verbose"},success:function(e){var t=e.d.results;if(e.d.results.length>0)for(var s=0;s<Number(t.length);s++)i.includes(t[s].Mission_Number)||i.push(t[s].Mission_Number)}}),i.length}function getLegTotal(e,t,s){var i=0;if(void 0!==e)var a="https://intelshare.intelink.gov/sites/89cs/GNOC/_api/web/lists/getbytitle('Missions')/items?$top=5000&$filter=DV eq '"+encodeURI(e)+"' and Created le '"+s+"' and Created ge '"+t+"'";else a="https://intelshare.intelink.gov/sites/89cs/GNOC/_api/web/lists/getbytitle('Missions')/items?$top=5000&$filter=Created le '"+s+"' and Created ge '"+t+"'";return $.ajax({url:a,async:!1,method:"GET",headers:{Accept:"application/json;odata=verbose"},success:function(e){e.d.results.length>0&&(i=Number(e.d.results.length))}}),i}function convertTheDate(e,t){var s=new Date(e),i=s.getUTCMonth();i=("0"+(s.getMonth()+1)).slice(-2);var a=s.getDate();s.getDate()<10&&(a="0"+s.getDate());var r=s.getUTCMinutes();s.getUTCMinutes()<10&&(r="0"+s.getUTCMinutes());new Date;if(1==t){var o=6e4*s.getTimezoneOffset();s.setTime(s.getTime()+o)}var n=s.getHours();return s.getHours()<10&&(n="0"+n),i+"/"+a+"/"+s.getUTCFullYear()+" "+n+":"+r+"Z"}function removeDuplicates(e){var t=[];return $.each(e,function(e,s){-1==$.inArray(s,t)&&t.push(s)}),t.sort()}function runLineChart(e){var t=["POTUS","VPOTUS","SECDEF","SECSTATE","CJCS"];if(void 0===e){var s=new Date;(e=s.getFullYear())+"-01-01T23:59:59Z",e+"-12-31T23:59:59Z"}else e+"-01-01T23:59:59Z",e+"-12-31T23:59:59Z";for(var i=0;i<t.length;i++){var a=t[i],r="https://intelshare.intelink.gov/sites/89cs/GNOC/_api/web/lists/getbytitle('Tickets')/items?$select=DV,Created&$top=5000&$filter=DV eq '"+encodeURI(a)+"'";$.ajax({url:r,async:!1,method:"GET",headers:{Accept:"application/json;odata=verbose"},success:function(t){var s=0,i=[],r=t.d.results;if(Number(r.length)>0){for(var o=0;o<Number(r.length);o++){var n=r[o].Created;i.includes(n)||i.push(n)}for(var l=[],c=1;c<13;c++){if(s=0,c<10)var d="0"+c;else d=c;for(var v=e+"-"+d+"-01T23:59:59Z",h=e+"-"+d+"-31T23:59:59Z",u=0;u<i.length;u++)i[u]<=h&&i[u]>=v&&s++;l.push(s)}lineOptions.series.push({name:a,data:l})}},error:function(e){}})}new Highcharts.Chart(lineOptions)}